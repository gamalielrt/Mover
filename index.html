<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sweatnet.net</title>
    <link rel="stylesheet" href="main.css">

</head>
<body>

    <div id="overlay">
        <div>
          <p>
            <label>Password</label>
            <input type = "password"
                    id = "myPwd"
                    value = "" />
          </p>
        <button id="startButton">Enter</button>
        </div>
    </div>
    <body style="background-color:#000000;">
    <script src="js/three.js"></script>
    <script src="js/MTLLoader.js"></script>
    <script src="js/OBJLoader.js"></script>
    <script src="js/OrbitControls.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.2/TweenMax.min.js"></script>

    <video id="videoalpha" loop crossOrigin="anonymous" playsinline style="display:none">
        <!--<source src="assets/drinkdrivealpha.webm" type='video/webm; codecs="vp8, vorbis"'>-->
        <source src="assets/draft9alpha.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>
    </video>

    <video id="video" loop crossOrigin="anonymous" playsinline style="display:none">
        <!--<source src="assets/drinkdrive.webm" type='video/webm; codecs="vp8, vorbis"'>-->
        <source src="assets/draft9.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>
    </video>

    <video id="videoscreen" loop crossOrigin="anonymous" autoplay="false" playsinline style="display:none">
        <!--<source src="assets/drinkdrive.webm" type='video/webm; codecs="vp8, vorbis"'>-->
        <source src="assets/draft8screens.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>
    </video>


    <script>

        




        var scene, camera, renderer, mesh, 
        objLoader, mtlLoader, GLTFLoader, keyLight, 
        fillLight, backLight, testLight, testLight1, testLight2, testLight3,
         testLight4, testLight5, testLight6, testLight7, testLight8,
        light1, sphereGeometry, sphereMaterial, 
        sphere, planeGeometry, planeMaterial, plane, textureloader, loader, fanblade ;
        

        var password = "";
        var meshFloor;
        var onHandset = true;
        var keyboard = {};
        var player = { height:450, speed:5, turnSpeed:Math.PI*0.01 };
        var USE_WIREFRAME = false;
        var lightColour = 0xD98400; //D98400
        var lightDistance = 10//10; //3
        var lightDecay = 700; //280
        var StageLightColour = 0x3333ff;
        var StageLightDistance = 9; //18
        var StageLightDecay = 450; //350
        var spotLightintensity = 2;
        var spotLightangle = 0.3;
        var spotLightpenumbra = 0.5;
        var spotLightdistance = 0;
        var spotLightdecay = 0;
        var count1 = {var:0};

        var loadingScreen = {
            scene: new THREE.Scene(),
            camera: new THREE.PerspectiveCamera(40, window.innerWidth / window.innerHeight, 0.1,100),
            box: new THREE.Mesh(
                new THREE.BoxGeometry(0.2,0.2,0.2),
                new THREE.MeshBasicMaterial({ color: 0x4444ff})
            )
        };

        var LOADING_MANAGER = null;
        var RESOURCES_LOADED = false;

        function addLights() {            
            
            
            //////////////// left light 1

            testLight = new THREE.PointLight(lightColour, lightDistance, lightDecay);//1, 750
            testLight.position.set(351,602,471);
            //testLight.castShadow = true;
            testLight.shadow.camera.near = 100;
            testLight.shadow.camera.far = 1000;

            scene.add(testLight);
            var sphereSize = 9;
            var pointLightHelper = new THREE.PointLightHelper( testLight, sphereSize );
            //scene.add( pointLightHelper );



            //////////////// left light 2

            testLight1 = new THREE.PointLight(lightColour, lightDistance, lightDecay);//750
            testLight1.position.set(9,626,834);
            //testLight1.castShadow = true;
            testLight1.shadow.camera.near = 100;
            testLight1.shadow.camera.far = 1000;

            scene.add(testLight1);



            //////////////// left light 3

            testLight3 = new THREE.PointLight(lightColour, lightDistance, lightDecay);//750
            testLight3.position.set(-414,618,884);
            //testLight3.castShadow = true;
            testLight3.shadow.camera.near = 100;
            testLight3.shadow.camera.far = 1000;

            scene.add(testLight3);
            var sphereSize = 40;
            var pointLightHelper = new THREE.PointLightHelper( testLight3, sphereSize );
            //scene.add( pointLightHelper );



            //////////////// left light 4

            testLight4 = new THREE.PointLight(lightColour, lightDistance, lightDecay);//750
            testLight4.position.set(-821,625,601);
            //testLight4.castShadow = true;
            testLight4.shadow.camera.near = 100;
            testLight4.shadow.camera.far = 1000;

            scene.add(testLight4);
            var sphereSize = 40;
            var pointLightHelper = new THREE.PointLightHelper( testLight4, sphereSize );
            //scene.add( pointLightHelper );



            //////////////// right light 1

            testLight5 = new THREE.PointLight(lightColour, lightDistance, lightDecay);//750
            testLight5.position.set(127,522,-297);
            //testLight5.castShadow = true;
            testLight5.shadow.camera.near = 100;
            testLight5.shadow.camera.far = 1000;

            scene.add(testLight5);
            var sphereSize = 40;
            var pointLightHelper = new THREE.PointLightHelper( testLight5, sphereSize );
            //scene.add( pointLightHelper );



            //////////////// stage light 1

            testLight6 = new THREE.PointLight(StageLightColour, StageLightDistance, StageLightDecay);//750
            testLight6.position.set(-116,737,202);
            //testLight6.castShadow = true;
            //testLight6.shadow.camera.near = 100;
            //testLight6.shadow.camera.far = 1000;

            scene.add(testLight6);
            //var sphereSize = 40;
            //var pointLightHelper = new THREE.PointLightHelper( testLight6, sphereSize );
            //scene.add( pointLightHelper );



            //////////////// stage light 2

            testLight7 = new THREE.PointLight(StageLightColour, StageLightDistance, StageLightDecay);//750
            testLight7.position.set(-378,737,138);
            //testLight6.castShadow = true;
            //testLight7.shadow.camera.near = 100;
            //testLight7.shadow.camera.far = 1000;

            scene.add(testLight7);
            //var sphereSize = 40;
            //var pointLightHelper = new THREE.PointLightHelper( testLight7, sphereSize );
            //scene.add( pointLightHelper );



            //////////////// stage light 3

            testLight8 = new THREE.PointLight(StageLightColour, StageLightDistance, StageLightDecay);//750
            testLight8.position.set(-227,737,367);
            //testLight6.castShadow = true;
            //testLight8.shadow.camera.near = 100;
            //testLight8.shadow.camera.far = 1000;

            scene.add(testLight8);
        }

        function startTimeline() {
           var tl = new TimelineMax();
           //tl.to(count1, 10, {var: 10, ease: Expo.easeOut});
           //tl.to(lightCount, 5, {var: 100, onUpdate: updateLights, ease: Expo.easeOut});
           tl.to(testLight, 5, {intensity: 1, ease: Expo.easeOut},8);
           tl.to(testLight1, 5, {intensity: 1, onUpdate: playVideo(),ease: Expo.easeOut},8);
           tl.to(testLight3, 5, {intensity: 1, ease: Expo.easeOut},8);
           tl.to(testLight4, 5, {intensity: 1, ease: Expo.easeOut},8);
           tl.to(testLight5, 5, {intensity: 1, ease: Expo.easeOut},8);
           tl.to(testLight6, 7, {intensity: 18, ease: Expo.easeOut},8);
           tl.to(testLight7, 7, {intensity: 18, ease: Expo.easeOut},8);
           tl.to(testLight8, 7, {intensity: 18, ease: Expo.easeOut},8);

           //tl.to(testLight5, 1, {intensity: 0, ease: Expo.easeOut},10);
           //tl.to(testLight6, 1, {intensity: 0, ease: Expo.easeOut},0);
           //tl.to(testLight7, 1, {intensity: 0, ease: Expo.easeOut},0);
           //tl.to(testLight8, 1, {intensity: 0, ease: Expo.easeOut},0);

        }

        function playVideo() {
            videoalpha.play();
            video.play();
        }





        function init(){


            //window.addEventListener('touchstart', function() {
            //    //the user touched the screen!
            //    onHandset = true
            //})


            //if (window.DeviceOrientationEvent) {
            //onHandset = true
            //}

            var overlay = document.getElementById( 'overlay' );
			overlay.remove();

            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera( 40, window.innerWidth / window.innerHeight, 0.1, 3000 );
            

            loadingScreen.box.position.set(0,0,5);
            loadingScreen.camera.lookAt(loadingScreen.box.position);
            loadingScreen.scene.add(loadingScreen.box);

            loadingManager = new THREE.LoadingManager();

            loadingManager.onProgress = function(item,loaded,total){
                console.log(item,loaded,total);
            };

            loadingManager.onLoad = function() {
                console.log("loaded all resources");
                RESOURCES_LOADED = true;
                var count1 = { var : 0};



                addLights();
                startTimeline();

//
                //tl.to(mesh.position, .5, {x: 2, ease: Expo.easeOut});
                //tl.to(mesh.rotation, .5, {y: Math.PI*.5, ease: Expo.easeOut}, "=-1.5");

                //videoalpha.play();
                //video.play();

            }

            //var sphereSize = 40;
            //var pointLightHelper = new THREE.PointLightHelper( testLight7, sphereSize );
            //scene.add( pointLightHelper );

            //startTimeline();


            
   

            var spotLight = new THREE.SpotLight(0x3333ff);
            spotLight.intensity = 1;
            spotLight.angle = 0.3;
            spotLight.penumbra = 0.5;
            spotLight.distance = 1;
            spotLight.decay = 0;
            spotLight.position.set(0,700,0);
            spotLight.target.position.set(-900, 0, 900);
            //spotlight.target.position.set(200,-130,400);
            //scene.add(spotLight);
            scene.add(spotLight.target);
            lightHelper = new THREE.SpotLightHelper( spotLight );
			//scene.add( lightHelper );


            mtlLoader = new THREE.MTLLoader(loadingManager);

            textureLoader = new THREE.TextureLoader(loadingManager);
            //var floortex = textureLoader.load('assets/floor_tex.jpg');
            //var floordis = textureLoader.load('assets/floor_dis2.jpg');
            var walltex = textureLoader.load('assets/wall_tex2.jpg');
            var ceilingtex = textureLoader.load('assets/ceilingtex.jpg');
            var curtaintex = textureLoader.load('assets/noisetex.jpg');
            var curtainnormaltex = textureLoader.load('assets/leathernormaltex.jpg');
            var stagetex = textureLoader.load('assets/noisenormaltex.jpg');


            //var stagetex = textureLoader.load('assets/stagetex.jpg');
            var video;

            walltex.wrapS = THREE.RepeatWrapping;
            walltex.wrapT = THREE.RepeatWrapping;
            walltex.repeat.set(40,40);

            curtaintex.wrapS = THREE.RepeatWrapping;
            curtaintex.wrapT = THREE.RepeatWrapping;
            curtaintex.repeat.set(3,7.5);

            curtainnormaltex.wrapS = THREE.RepeatWrapping;
            curtainnormaltex.wrapT = THREE.RepeatWrapping;
            curtainnormaltex.repeat.set(3,7.5);

            ceilingtex.wrapS = THREE.RepeatWrapping;
            ceilingtex.wrapT = THREE.RepeatWrapping;
            ceilingtex.repeat.set(2,2);
            

            //var plane = new THREE.PlaneGeometry(1200,1200,10,10);
            //var floormtl = new THREE.MeshStandardMaterial();
            //floormtl.map = floortex;
            //floormtl.colour = 0x000000;
            //floormtl.displacementMap = floordis;
            //floormtl.displacementScale = 3;
            //floormtl.displacementBias = 1;
            //floormtl.metalness = 0.3;
            //floormtl.roughness = 1;
            //var floorplane = new THREE.Mesh(plane, floormtl);
            //floorplane.position.y = 300;  
            //floorplane.rotation.x = -Math.PI/2; 
            //floorplane.receiveShadow = true;
            //scene.add(floorplane);    

            

            ////////////// hologram
            
            video = document.getElementById( 'video' );
            video.load();
            
            var vidplane = new THREE.PlaneGeometry(193,193,10,10);
            var vidtexture = new THREE.VideoTexture( video );

            videoalpha = document.getElementById( 'videoalpha' );
            videoalpha.load();
			
            
            //videoalpha.play();
            //video.play();

            var vidalphatexture = new THREE.VideoTexture( videoalpha );
            
            var vidplanemtl = new THREE.MeshStandardMaterial(loadingManager);
            vidplanemtl.map = vidtexture;
            vidplanemtl.alphaTest = 0.5;
            vidplanemtl.alphaMap = vidalphatexture;
            vidplanemtl.transparent = true;
            vidplanemtl.opacity = 0.7;



            var vidplanemesh = new THREE.Mesh(vidplane, vidplanemtl);
            vidplanemesh.position.set(-260, 530, 220);
            vidplanemesh.rotation.y = 2.3;
            scene.add(vidplanemesh); 
            
            
            /////////////////// tv screens

            videoscreen = document.getElementById( 'videoscreen' );
            videoscreen.load();
			videoscreen.play();
            var vidscreenplane = new THREE.PlaneGeometry(60,60,10,10);
            var vidscreentexture = new THREE.VideoTexture( videoscreen );
            
            var vidscreenplanemtl = new THREE.MeshStandardMaterial(loadingManager);
            vidscreenplanemtl.map = vidscreentexture;
            vidscreenplanemtl.alphaTest = 0;
            vidscreenplanemtl.transparent = true;
            vidscreenplanemtl.opacity = 0.3;
            //vidscreenplanemtl.emissive = 0x3333ff;
            //vidscreenplanemtl.map = ceilingtex;
            //vidscreenplanemtl.emissiveIntensity = 4;




            var vidscreenplanemesh = new THREE.Mesh(vidscreenplane, vidscreenplanemtl);
            vidscreenplanemesh.position.set/*(-100,500,0); //*/(-829, 413, 899);
            vidscreenplanemesh.rotation.set(0.3,2.5,-1.7)//(-0.663, 3.333, -1.57);
            //scene.add(vidscreenplanemesh);  


            var sphere = new THREE.SphereBufferGeometry();
            var box = new THREE.BoxHelper( vidscreenplanemesh, 0xffff00 );
            //scene.add( box );


            ////////////////////   floor

            var floormtl = new THREE.MeshLambertMaterial({
                map : ceilingtex,
                color: 0x0d0d0d

            });

            loader = new THREE.OBJLoader(loadingManager);
            loader.load( 'assets/newfloor.obj', function ( floormesh ) {
                            

                floormesh.traverse( function ( node ) {

                    if ( node.isMesh ) node.material = floormtl;             
                    node.castShadow = true;                       
                    node.receiveShadow = true;
                } );

                floormesh.position.y = 300;
                scene.add( floormesh );
            });

            ////////////////////   walls + centre
            

            var wallscentremtl = new THREE.MeshLambertMaterial({
                map : ceilingtex,
                //shininess : 0,
                color: 0x191919,
                normalMap: curtainnormaltex,
            });

            loader = new THREE.OBJLoader(loadingManager);
            loader.load( 'assets/newwallscentre.obj', function ( wallscentremesh ) {
                            

                wallscentremesh.traverse( function ( node ) {

                    if ( node.isMesh ) node.material = wallscentremtl;             
                    node.castShadow = true;
                } );

                wallscentremesh.position.y = 297;
                scene.add( wallscentremesh );
            });

            ////////////////////   stools + tables
            

            var stoolstablesmtl = new THREE.MeshStandardMaterial({
                //map : ceilingtex,
                metalness : 0.8,
                roughness : 0.2,
                color: 0x1c1c1c,
                //emissiveIntensity: 100
                

            });

            loader = new THREE.OBJLoader(loadingManager);
            loader.load( 'assets/newstoolstables1.obj', function ( stoolstablesmesh ) {
                            

                stoolstablesmesh.traverse( function ( node ) {

                    if ( node.isMesh ) node.material = stoolstablesmtl;             

                } );

                stoolstablesmesh.position.y = 300;
                scene.add( stoolstablesmesh );
            });

            ////////////////////   chair tops

            var chairtopmtl = new THREE.MeshStandardMaterial({
                map : curtaintex,
                metalness : 0.5,
                roughness : 0.5,
                color: 0x000000,
                emissive: 0x800080,
                //emissiveIntensity: 100
                emissiveMap: curtainnormaltex,
                emissiveIntensity : 0.1,
                normalMap: curtainnormaltex,
                normalScale: new THREE.Vector2( 0, 0.5 )

            });

            //chairtopmtl.normalMap = curtainnormaltex;



            loader = new THREE.OBJLoader(loadingManager);
            loader.load( 'assets/newchairtops.obj', function ( chairtopmesh ) {
                            

                chairtopmesh.traverse( function ( node ) {

                    if ( node.isMesh ) node.material = chairtopmtl;             

                } );

                chairtopmesh.position.y = 300;
                scene.add( chairtopmesh );
            });

            ////////////////////   bar

            var barmtl = new THREE.MeshStandardMaterial({
                //map : ceilingtex,
                metalness : 1,
                roughness : 1,
                color: 0x8c8c8c,
                //emissiveIntensity: 100

            });

            loader = new THREE.OBJLoader(loadingManager);
            loader.load( 'assets/newbar.obj', function ( barmesh ) {
                            

                barmesh.traverse( function ( node ) {

                    if ( node.isMesh ) node.material = barmtl;             

                } );

                barmesh.position.y = 300;
                scene.add( barmesh );
            }); 

            ////////////////////   metal

                var metalmtl = new THREE.MeshPhongMaterial({
                map : ceilingtex,
                shininess : 30,
                color: 0x404040,
                //emissiveIntensity: 100

            });

            loader = new THREE.OBJLoader(loadingManager);
            loader.load( 'assets/newmetal.obj', function ( metalmesh ) {
                            

                metalmesh.traverse( function ( node ) {

                    if ( node.isMesh ) node.material = metalmtl;             

                } );

                metalmesh.position.y = 300;
                scene.add( metalmesh );
            }); 

            ////////////////////   speakers    
            
            var speakersmtl = new THREE.MeshPhongMaterial({
                //map : ceilingtex,
                shininess : 15,
                color: 0x000000,
                //emissiveIntensity: 100

            });

            loader = new THREE.OBJLoader(loadingManager);
            loader.load( 'assets/newspeakers.obj', function ( speakersmesh ) {
                            

                speakersmesh.traverse( function ( node ) {

                    if ( node.isMesh ) node.material = speakersmtl;             
                    node.castShadow = true;
                    node.receiveShadow = true;
                } );

                speakersmesh.position.y = 300;
                scene.add( speakersmesh );
            });

            ////////////////////   tv + light metal

            var tvlightsmtl = new THREE.MeshStandardMaterial({
                map : ceilingtex,
                metalness : 0.5,
                color: 0x595959,
                //emissiveIntensity: 100

            });

            loader = new THREE.OBJLoader(loadingManager);
            loader.load( 'assets/newtvlightmetal.obj', function ( tvlightsmesh ) {
                            

                tvlightsmesh.traverse( function ( node ) {

                    if ( node.isMesh ) node.material = tvlightsmtl;             

                } );

                tvlightsmesh.position.y = 300;
                scene.add( tvlightsmesh );
            });  

            ////////////////////   light tops

            var lighttopsmtl = new THREE.MeshStandardMaterial({
                //map : ceilingtex,
                transparent : true,
                opacity : 0.68,
                metalness : 0.6,
                roughness : 0.2,
                color: 0xff6600,
                //emissiveIntensity: 100

            });

            loader = new THREE.OBJLoader(loadingManager);
            loader.load( 'assets/newlighttops.obj', function ( lighttopsmesh ) {
                            

                lighttopsmesh.traverse( function ( node ) {

                    if ( node.isMesh ) node.material = lighttopsmtl;
                                 
                    node.castShadow = true;
                    node.receiveShadow = true;             

                } );

                lighttopsmesh.position.y = 300;
                scene.add( lighttopsmesh );
            });  

            ////////////////////   tv screens

            var tvscreensmtl = new THREE.MeshPhongMaterial({
                shininess : 30,

                //roughness : 0,
                color: 0x000000,
                //specular: 0x000000
                //emissiveIntensity: 100

            });

            loader = new THREE.OBJLoader(loadingManager);
            loader.load( 'assets/newtvscreens.obj', function ( tvscreensmesh ) {
                            

                tvscreensmesh.traverse( function ( node ) {

                    if ( node.isMesh ) node.material = tvscreensmtl;             

                } );

                // Add the model to the scene.
                tvscreensmesh.position.y = 300;
                scene.add( tvscreensmesh );
            });  

            ////////////////////   cables


            var cablesmtl = new THREE.MeshPhongMaterial({
                //map : ceilingtex,
                //envMap : ceilingtex,
                //roughness : 0.5,
                //metalness : 1,
                color: 0x000000,
                shininess : 100, 
                //ambient: 0x030303, 
                //specular: 0x009900,
                //refractionRatio : 0.5,
                //emissiveIntensity: 100

            });

            loader = new THREE.OBJLoader(loadingManager);
            loader.load( 'assets/newcables1.obj', function ( cablesmesh ) {
                            

                cablesmesh.traverse( function ( node ) {

                    if ( node.isMesh ) node.material = cablesmtl;             

                } );

                cablesmesh.position.y = 300;
                scene.add( cablesmesh );
            });  

            ////////////////////   stage surface
            
            var stagesurfacemtl = new THREE.MeshStandardMaterial({
                //map : curtaintex,
                metalness: 0,
                roughness : 1,
                color: 0x000000,
                emissiveMap: vidscreentexture,
                emissiveIntensity: 1,
                emissive: 0x1a1aff,


            });

            loader = new THREE.OBJLoader(loadingManager);
            loader.load( 'assets/newstagesurface.obj', function ( stagesurfacemesh ) {
                            

                stagesurfacemesh.traverse( function ( node ) {

                    if ( node.isMesh ) node.material = stagesurfacemtl;             

                } );

                stagesurfacemesh.position.y = 300;
                scene.add( stagesurfacemesh );
            });  

            ////////////////////   fan cases

            var fancasemtl = new THREE.MeshPhongMaterial({
                map : ceilingtex,
                shininess : 20,
                color: 0xbfbfbf,
                //emissiveIntensity: 100

            });

            loader = new THREE.OBJLoader(loadingManager);
            loader.load( 'assets/newfancases.obj', function ( fancasemesh ) {
                            

                fancasemesh.traverse( function ( node ) {

                    if ( node.isMesh ) node.material = fancasemtl;             

                } );

                fancasemesh.position.y = 300;
                scene.add( fancasemesh );
            }); 

            ////////////////////   fan1

            var fan1mtl = new THREE.MeshPhongMaterial({
                map : ceilingtex,
                shininess : 20,
                color: 0xbfbfbf,
                //emissiveIntensity: 100

            });

            loader = new THREE.OBJLoader(loadingManager);
            loader.load( 'assets/newfan1.obj', function ( fan1mesh ) {
                            

                fan1mesh.traverse( function ( node ) {

                    if ( node.isMesh ) node.material = fan1mtl;             

                } );

                fan1mesh.position.set(0,300,0);

                //fan1mesh.position.set(-317,585,516);
                //fan1mesh.rotation.set(1.6219,2.0266,0.7611);

                fan1 = fan1mesh;

                scene.add( fan1 );
            });

            
            ////////////////////  fan2

            var fan2mtl = new THREE.MeshPhongMaterial({
                map : ceilingtex,
                shininess : 20,
                color: 0xbfbfbf,
                //emissiveIntensity: 100

            });

            loader = new THREE.OBJLoader(loadingManager);
            loader.load( 'assets/newfan2.obj', function ( fan2mesh ) {
                            

                fan2mesh.traverse( function ( node ) {

                    if ( node.isMesh ) node.material = fan2mtl;             

                } );

                fan2mesh.position.set(0,300,0);

                //fan2mesh.position.set(-58,501,1);
                //fan2mesh.rotation.set(0.1905,2.0607,0.4307);

                fan2 = fan2mesh;
                scene.add( fan2 );
            });





          
            
            //camera.position.set(400, player.height, -500);
            //camera.lookAt(new THREE.Vector3(0,player.height,0));
            
            renderer = new THREE.WebGLRenderer({ antialias: true });
            
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            
            renderer.setSize( window.innerWidth, window.innerHeight );
            
            document.body.appendChild(renderer.domElement);

            //var controls = new OrbitControls( camera, renderer.domElement );

            //if (window.DeviceOrientationEvent) {
                //onHandset = true //change
            //}

            if ( onHandset == true){

                var controls = new THREE.OrbitControls( camera, renderer.domElement );
                controls.enableDamping = false;
                controls.dampingFactor = 0.1;

                //controls.minDistance = 0;
                //controls.maxDistance = 3000;

                controls.maxPolarAngle = 2;
                controls.minPolarAngle = -2;

                controls.keyPanSpeed = 50;
                controls.PanSpeed = 50;
                //controls.zoomSpeed = 50;


                controls.target = new THREE.Vector3(700,498,50);
                camera.position.set(900, 498, -20);

                //camera.lookAt(new THREE.Vector3(-269, 343, 228));

                //controls.update() must be called after any manual changes to the camera's transform
                //camera.position.set( 0, 20, 100 );
                controls.update();

            }

            console.log(onHandset);
            //animate();
        };

        function animate(){

            if (RESOURCES_LOADED == false){
                requestAnimationFrame(animate);

                loadingScreen.box.rotation.x -= 0.04;
                loadingScreen.box.rotation.y -= 0.04;
                loadingScreen.box.position.y = Math.sin(loadingScreen.box.position.x);
                if (loadingScreen.box.position.x < -10 ) loadingScreen.box.position.x = 10;

                renderer.render(loadingScreen.scene, loadingScreen.camera);
                
                return;
            }

            requestAnimationFrame(animate);

            //fan1.rotation.y += 0.01;
            //fan2.rotation.y += 0.015;


            //var gyroPresent = false;
            //window.addEventListener("devicemotion", function(event){
            //    if(event.rotationRate.alpha || event.rotationRate.beta || event.rotationRate.gamma) {
            //        gyroPresent = true
            //    } 
            //    else {gyroPresent = false};
            //}
            //);

            //if (window.DeviceOrientationEvent) {
            //    gyroPresent = true
            //}

            //var ua = new UAParser();
            //var result = ua.getResult();
            //console.log(result);
//
//
            //console.log(result.browser);
            //console.log(result.device);
            //console.log(result.os);

            if ( onHandset == false ) {
                
                // Keyboard movement inputs
                if(keyboard[87]){ // W key
                    camera.position.x -= Math.sin(camera.rotation.y) * player.speed;
                    camera.position.z -= -Math.cos(camera.rotation.y) * player.speed;
                }
                if(keyboard[83]){ // S key
                    camera.position.x += Math.sin(camera.rotation.y) * player.speed;
                    camera.position.z += -Math.cos(camera.rotation.y) * player.speed;
                }
                if(keyboard[65]){ // A key
                    // Redirect motion by 90 degrees
                    camera.position.x += Math.sin(camera.rotation.y + Math.PI/2) * player.speed;
                    camera.position.z += -Math.cos(camera.rotation.y + Math.PI/2) * player.speed;
                }
                if(keyboard[68]){ // D key
                    camera.position.x += Math.sin(camera.rotation.y - Math.PI/2) * player.speed;
                    camera.position.z += -Math.cos(camera.rotation.y - Math.PI/2) * player.speed;
                }
                
                // Keyboard turn inputs
                if(keyboard[37]){ // left arrow key
                    camera.rotation.y -= player.turnSpeed;
                }
                if(keyboard[39]){ // right arrow key
                    camera.rotation.y += player.turnSpeed;
                }
            } else if ( onHandset == true) {
                //controls.update();

            }

            //contols.update();
            
            renderer.render(scene, camera);
        }

        function keyDown(event){
            keyboard[event.keyCode] = true;
        }

        function keyUp(event){
            keyboard[event.keyCode] = false;
        }

        window.addEventListener('keydown', keyDown);
        window.addEventListener('keyup', keyUp);

        //window.onload = init;

    var startButton = document.getElementById( 'startButton' );
		startButton.addEventListener( 'click', function () {
                var inputpassword = document.getElementById("myPwd").value;
                if (inputpassword == password) {
                    init();
		            animate();

                };
		}, false );
        

    </script>
</body>
</html>